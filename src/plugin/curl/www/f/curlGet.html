<!DOCTYPE html>
<html>
  <head>
    <title>curlGet</title>
    <link rel="stylesheet" type="text/css" href="../../jsoncalc.css">
    <meta name="description" content="jsoncalc curlGet - Send an HTTP/HTTPS GET request">
    <meta name="keywords" content="string, number, array, object, boolean, datetime, aggregate, jsoncalc, function reference, curlGet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <h1>curlGet - Send an HTTP GET request</h1>
    <dl>
      <dt>plugin curl;
      <br/>curlGet( <var>url</var><span class="type">:string</span>, <var>query</var><span class="type">?:string|object|null</span>, <var>flags</var><span class="type">?:array</span>, <var>flag</var><span class="type">?:number</span>, ... ) <span class="type">:string|any</span>
      <dd>
      This is part of the <a target="_PARENT" href="../../index.html?p=curl">curl</a> plugin.
      You must load the plugin via either -lcurl on the shell command line,
      or a <tt>plugin curl;</tt> line in a script.
      This sends a request and returns the response.
      Typically the request URL would be use "http:" or "https:" but
      other protocols such as "sftp:" are supported too.
      <p>
      The <tt>url</tt> argument is required.
      All other arguments are optional.
      <p>
      If the <tt>url</tt> is followed by a string or object, it is taken to
      be a query to append to the URL.
      A string will be appended verbatim.
      An object must only have member values that are strings or numbers,
      and they will be converted to a series of name=value pairs as though
      from an HTML form, with URL encoding done automatically.
      For example, <tt>{season:"All Season"}</tt> would append
      "?season=All%20Season" to the URL.
      If you don't want to send query data but to want to use flags,
      then you should pass an explicit <tt>null</tt> as the query parameter.
      <p>
      The remaining parameters are all flags, or arguments associated with
      flags.
      The flags are numbers, but there's a <tt>CURL</tt> object which
      defines symbolic names for the numbers,
      so you'll generally want to use those.
      For example, use <tt>CURL.bearer_</tt> instead of its number
      (which happens to be 4).
      The underscore at the end of the symbolic name is a clue that this
      flag requires an extra parameter, specifically a bearer token in
      this case.
      <p>
      You can pass flags( and their extra parameter if they use one) either
      as separate function parameters, or in an array, or a mixture.
      In practice, it is often convenient to collect common flags in an
      array, and then pass request-specific flags as extra parameters.
    </dl>
    <details open>
      <summary>Examples</summary>

      <div class="example">
	<kbd>curlGet("http://localhost/", CURL.raw)</kbd>
	<samp><i>Some big HTML string</i></samp>
        This attempts to fetch the main index of a local HTTP server.
        Assuming you have one running, you should receive an HTML document
        back, as a string.
      </div>

      <div class="example">
	<kbd>const data={size:"L", color:"Brown", odor: "None"};</kbd>
	<kbd>curlGet("https://example.net/app/request.json", data, CURL.username_, "steve", CURL.password_, "haBiBi")</kbd>
	<samp><i>A bunch of parsed data.</i></samp>
	First we build an object containing data to append to the URL.
	Then we run <tt>curlGet()</tt> passing it the URL, the data, and some
	flags.
	The flags define the user name and password (and imply that
	"Authentication: Basic" should be used).
	The lack of a <tt>CURL.raw</tt> flag means the response will be parsed.
      </div>

      <div class="example">
        <kbd>curlGet("https://swapi.py4e.com/api/people/",{search:"darth"}).results@{name,height,mass,films:(films@curlGet(this).title).join("\n")}</kbd>
        <samp>
<table>
<tr><th>name</th><th>height</th><th>mass</th><th>films</th></tr>
<tr><td>Darth Vader</td><td>202</td><td>136</td><td>A New Hope</td></tr>
<tr><td></td><td></td><td></td><td>The Empire Strikes Back</td></tr>
<tr><td></td><td></td><td></td><td>Return of the Jedi</td></tr>
<tr><td></td><td></td><td></td><td>Revenge of the Sith</td></tr>
<tr><td>Darth Maul</td><td>175</td><td>80</td><td>The Phantom Menace</td></tr>
<tr><td></td></tr>
</table>
        </samp>
        A nice big example, accessing the Star Wars API.
        First we obtain a list (in the <tt>results</tt> member) of characters matching
        the search text "darth".
        We then select just the <tt>name</tt>, <tt>height</tt>, <tt>mass</tt>,
        and <tt>films</tt> members for each character...
        but the <tt>films</tt> member is an array of URLs referencing the
        films, and we want titles, so we fetch each URL and grab just the
        <tt>title</tt> member of each returned object.
        As a final step, we join each character's array of titles into one long string,
        delimited by newlines.
        The "grid" table display method knows how to handle newlines.
        <p>
        Darth Maul didn't even survive one film.  What a wuss.
      </div>

    </details>

    <details>
      <summary>Notes</summary>
      <ul>

        <li>If you pass query data as a string instead of an object, then
            you must ensure that the string is URL-encoded.
            This will probably involve calling <a target="_PARENT" href="../../index.html?f=curl/encodeURIComponent">encodeURIComponent()</a>.

        <li>To avoid having to repeat your login credentials with every request,
            you may need to enable cookies by adding a <tt>CURL.cookies</tt>
            flag.

      </ul>
    </details>

    <details>
      <summary>See Also</summary>
      <table>
        <tr><td><a target="_PARENT" href="../../index.html?p=curl">plugin curl</a></td><td>Overview of the curl plugin</td><tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/curlPost">curlPost()</a></td><td>Send an HTTP/HTTPS "POST" request</td></tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/curlOther">curlOther()</a></td><td>Send an HTTP/HTTPS request other than "GET" or "POST"</td></tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/encodeURIComponent">encodeURIComponent()</a></td><td>Make a string safe to pass as part of a URL</td></tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/mime64">mime64()</a></td><td>Encode a string using MIME64</td></tr>
      </table>
    </details>

  </body>
</html>
