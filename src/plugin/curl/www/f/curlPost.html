<!DOCTYPE html>
<html>
  <head>
    <title>curlPost</title>
    <link rel="stylesheet" type="text/css" href="../../jsoncalc.css">
    <meta name="description" content="jsoncalc curlPost - Send an HTTP/HTTPS POST request">
    <meta name="keywords" content="string, number, array, object, boolean, datetime, aggregate, jsoncalc, function reference, curlPost">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <h1>curlPost - Send an HTTP/HTTPS "POST" request</h1>
    <dl>
      <dt>plugin curl;
      <br/>curlPost( <var>url</var><span class="type">:string</span>, <var>content</var><span class="type">:string|any</span>, <var>flags</var>?<span class="type">:array</span>, <var>flag</var>?<span class="type">:number</span>, ... ) <span class="type">:string|any</span>
      
      <dd>
      This is part of the <a target="_PARENT" href="../../index.html?p=curl">curl</a> plugin.
      You must load the plugin via either -lcurl on the shell command line,
      or a <tt>plugin curl;</tt> line in a script.
      <p>
      This sends an HTTP or HTTPS "POST" request, and returns the response.
      POST requests differ from GET in that any added data is sent as the
      content of the request, instead of being built into the URL.
      This allows POST requests to send larger data with a complex structure.
      The MIME "Content-type:" is chosen as follows:
      <ul>
        <li>You can use the <tt>CURL.reqcontenttype_</tt> flag to explicitly
            declare the MIME type of the content, usually one of
            "application/x-www-form-urlencoded", "application/json" or
            "application/xml".
            If the content is passed as a string, it'll be sent unmodified.
            If the content is passed as any other JSON data type, it'll be
            converted to HTML form data or JSON depending on the declared type.
            Note that if you're sending XML data, you must convert it
            to a string yourself and pass that as the data.
	<li>If you don't explicitly declare the content type,
	    then <tt>curlPost</tt> will try to guess the type.
	  <ul>
	    <li>If the content is a string, it will
	        guess "application/json" if the string starts with "{" or "[", or
	        guess "application/xml" if the string starts with "<", or
	        guess "application/x-www-form-urlencoded" otherwise.
	    <li>If the content is an array, it will be serialized as JSON
	        and sent as "application/json".
            <li>If the content is an object, then the object's members are
                inspected and if their values are all simple strings or numbers,
                then it'll be converted to an HTML query string and sent as
                "application/x-www-form-urlencoded";
	        Otherwise it'll be serialized as JSON and sent as
	        "application/json".
	  </ul>
	<li>If none of the above resolves the type, or if you request a type that can't represent the given data, then the function fails.
      </ul>
      <p>
      The <tt>url</tt> and <tt>content</tt> arguments are required.
      Other parameters (flags) are optional.
      <p>
      Any arguments after that should be a flag as listed in the
      "Other Features" section of the 
      <a target="_PARENT" href="../../index.html?p=curl">curl</a> plugin
      overview.
      Some of these flags require extra data which should be given as the
      argument following the flag;
      their names end with a "_" character as a clue that more info is needed.
      For example, the <tt>CURL.bearer_</tt> flag should always be followed
      by the bearer token string.
      <p>
      You can pass the flags (and their extra parameter, if any) either as
      separate parameters to the function, or in an array, or a mixture.
      Often, shared flags will be collected in an array, and then any
      request-specific flags are added after that as separate arguments.
    </dl>
    <details open>
      <summary>Examples</summary>

      <div class="example">
	<kbd>const data={size:"L", color:"Brown", odor: "None"};</kbd>
	<kbd>curlPost("https://example.net/app/request.json", data, CURL.decode, CURL.bearer_, token)</kbd>
	<samp><i>A bunch of parsed data.</i></samp>
	First we build an object containing data to send as the request's content.
	Then we call <tt>curlPost()</tt>, passing it the URL and the data,
	followed by flags.
	The <tt>CURL.decode</tt> flag tells it to attempt to decode the response
	so we get an object back instead of a big string of JSON source code.
	The <tt>CURL.bearer_</tt> flag tells it to use "Authentication: Bearer"
	with the bearer token that's stored in a "token" variable.
	The parsed response data is then returned.
      </div>

    </details>

    <details>
      <summary>Notes</summary>
      <ul>

        <li>Passing a <tt>CURL.decode</tt> flag to parse the response also
            implies that the request headers should include an
            "Accept: application/json" header line.
            However, if you've loaded another plugin that supports parsing
            other data formats (e.g., the "csv" or "xml" plugins) then those
            will be recognized and parsed too.

      </ul>
    </details>

    <details>
      <summary>See Also</summary>
      <table>
        <tr><td><a target="_PARENT" href="../../index.html?p=curl">plugin curl</a></td><td>Overview of the curl plugin</td><tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/curlGet">curlGet()</a></td><td>Send an HTTP/HTTPS "GET" request</td></tr>
        <tr><td><a target="_PARENT" href="../../index.html?f=curl/curlOther">curlOther()</a></td><td>Send an HTTP/HTTPS request other than "GET" or "POST"</td></tr>
      </table>
    </details>

  </body>
</html>
